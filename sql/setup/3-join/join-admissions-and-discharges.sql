drop materialized view if exists derived.joined_admissions_and_discharges cascade;
create materialized view derived.joined_admissions_and_discharges as 
select
a.uid,
a.ingested_at as admission_form_ingested_at,
d.ingested_at as discharge_form_ingested_at,
a."Abdomen",
a."Activity",
a."AdmittedFrom",
a."AdmReason",
a."AdmReasonOth",
a."AgeA",
a."AgeB",
a."AgeC",
a."AgeCat",
a."ANMatSyphTreat",
a."ANSteroids",
a."AntenatalCare",
a."Anus2",
a."ANVDRL",
a."ANVDRLDate",
a."ANVDRLResult",
a."Apgar1",
a."Apgar10",
a."Apgar5",
a."AW",
a."BabyCryTriage",
a."BirthFacility",
a."BirthPlaceSame",
a."BrProbs",
a."BSmg",
a."BSmmol",
a."BW",
a."Cadre",
a."ChestAusc",
a."Chlor",
a."Colour",
a."CRT",
a."CryBirth",
a."DangerSigns",
a."DangerSigns2",
a."DateHIVtest",
a."DateTimeAdmission",
a."DateVDRLSameHIV",
a."Diagnoses",
a."DiagnosesOth",
a."DurationLab",
a."Dysmorphic",
a."EndScriptDatetime" as admission_endscriptdatetime,
a."Ethnicity",
a."EthnicityOther",
a."FeedingReview",
a."FeFo",
a."Femorals",
a."FitsTh",
a."Fontanelle",
a."FontTh",
a."FurtherTriage",
a."Gender",
a."Genitalia",
a."Gestation",
a."GraspTh",
a."GSCvsOM",
a."HAART",
a."HCWID",
a."HCWSig",
a."HeadShape",
a."HIVtestResult",
a."HR",
a."HypoSxYN",
a."InOrOut",
a."IPT",
a."LengthHAART",
a."LengthResus",
a."LengthResusKnown",
a."LOCTh",
a."ManualHR",
a."MaritalStat",
a."MatAgeYrs",
a."MatHIVtest",
a."MatPhysAddressDistrict",
a."MecPresent",
a."MecThickThin",
a."MethodEstGest",
a."ModeDelivery",
a."MoroTh",
a."MSKproblems",
a."Murmur",
a."NVPgiven",
a."OFC",
a."OtherBirthFacility",
a."OtherReferralFacility",
a."Palate",
a."PassedMec",
a."PlaceBirth",
a."Plan",
a."PlanOth",
a."PostTh",
a."PregConditions",
a."Presentation",
a."ProbsLab",
a."PUInfant",
a."PUNewborn",
a."Readmission",
a."Reason",
a."ReasonOther",
a."ReferredFrom",
a."ReferredFrom2",
a."Religion",
a."ReligionOther",
a."RespSR",
a."RespTh",
a."Resus",
a."RFSepsis",
a."ROM",
a."ROMLength",
a."RR",
a."SatsAir",
a."SatsO2",
a."SignsDehydrations",
a."SignsRD",
a."Skin",
a."Spine",
a."SRNeuroOther",
a."Stethoscope",
a."StoolsInfant",
a."SuckReflex",
a."SuckTh",
a."Temperature",
a."TestThisPreg",
a."TetraEye",
a."ThompScore",
a."Tone",
a."ToneTh",
a."Tribe",
a."TribeOther",
a."TTV",
a."TypeBirth",
a."Umbilicus",
a."VitK",
a."Vomiting",
a."WOB",
d."Apgar10DC",
d."Apgar1DC",
d."Apgar5DC",
d."BWDC",
d."CadreDis",
d."CauseDeath",
d."CauseDeathOther",
d."CLINREVDAT",
d."ContCauseDeath",
d."ContribOth",
d."DateAdmissionDC",
d."DateDischVitals",
d."DateDischWeight",
d."DateTimeDeath",
d."DateTimeDischarge",
d."DateWeaned",
d."DIAGDIS1",
d."DIAGDIS1OTH",
d."DischHR",
d."DischRR",
d."DischSats",
d."DischTemp",
d."DischWeight",
d."EndScriptDatetime" as discharge_endscriptdatetime,
d."FeedsAdm",
d."GestationDC",
d."HCWIDDis",
d."HCWSigDis",
d."HealthEd",
d."HIVtestResultDC",
d."MEDOTH",
d."MedsGiven",
d."ModeDeliveryDC",
d."ModFactor1",
d."ModFactor2",
d."ModFactor3",
d."NeoTreeID",
d."NeoTreeOutcome",
d."OtherProbs",
d."OtherProbsOth",
d."PHOTOTHERAPY",
d."RESPSUP",
d."REVCLIN",
d."REVCLINOTH",
d."REVCLINTYP",
d."ThermCare",
d."UIDDC"
from derived.admissions a 
left join derived.discharges d 
on a.uid = d.uid;